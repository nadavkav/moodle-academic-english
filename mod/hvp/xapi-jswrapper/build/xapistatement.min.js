!function(a){function b(a,c){var d=c.split("."),e=d[0];return c=d.slice(1).join("."),a[e]||(/\[\]$/.test(e)?(e=e.slice(0,-2),a[e]=[]):a[e]={}),c?b(a[e],c):a[e]}var c=function(b,c,j){if(b&&b.actor&&b.verb&&b.object){var k=b;for(var l in k)"actor"!=l&&"verb"!=l&&"object"!=l&&(this[l]=k[l]);b=k.actor,c=k.verb,j=k.object}b?b instanceof d?this.actor=b:"Agent"!==b.objectType&&b.objectType?"Group"===b.objectType&&(this.actor=new e(b)):this.actor=new d(b):this.actor=null,c?c instanceof f?this.verb=c:this.verb=new f(c):this.verb=null,j?"Activity"!==j.objectType&&j.objectType?"Agent"===j.objectType?j instanceof d?this.object=j:this.object=new d(j):"Group"===j.objectType?j instanceof e?this.object=j:this.object=new e(j):"StatementRef"===j.objectType?j instanceof h?this.object=j:this.object=new h(j):"SubStatement"===j.objectType?j instanceof i?this.object=j:this.object=new i(j):this.object=null:j instanceof g?this.object=j:this.object=new g(j):this.object=null,this.generateId=function(){this.id=a.ruuid()}};c.prototype.toString=function(){return this.actor.toString()+" "+this.verb.toString()+" "+this.object.toString()},c.prototype.isValid=function(){return this.actor&&this.actor.isValid()&&this.verb&&this.verb.isValid()&&this.object&&this.object.isValid()},c.prototype.generateRegistration=function(){b(this,"context").registration=a.ruuid()},c.prototype.addParentActivity=function(a){b(this,"context.contextActivities.parent[]").push(new g(a))},c.prototype.addGroupingActivity=function(a){b(this,"context.contextActivities.grouping[]").push(new g(a))},c.prototype.addOtherContextActivity=function(a){b(this,"context.contextActivities.other[]").push(new g(a))};var d=function(a,b){if(this.objectType="Agent",this.name=b,a&&(a.mbox||a.mbox_sha1sum||a.openid||a.account))for(var c in a)this[c]=a[c];else/^mailto:/.test(a)?this.mbox=a:/^[0-9a-f]{40}$/i.test(a)?this.mbox_sha1sum=a:/^http[s]?:/.test(a)?this.openid=a:a&&a.homePage&&a.name&&(this.account=a)};d.prototype.toString=function(){return this.name||this.mbox||this.openid||this.mbox_sha1sum||this.account.name},d.prototype.isValid=function(){return this.mbox||this.mbox_sha1sum||this.openid||this.account.homePage&&this.account.name||"Group"===this.objectType&&this.member};var e=function(a,b,c){d.call(this,a,c),this.member=b,this.objectType="Group"};e.prototype=new d;var f=function(a,b){if(a&&a.id)for(var c in a)this[c]=a[c];else this.id=a,b&&("string"==typeof b||b instanceof String?this.display={"en-US":b}:this.display=b)};f.prototype.toString=function(){return this.display&&(this.display["en-US"]||this.display.en)?this.display["en-US"]||this.display.en:this.id},f.prototype.isValid=function(){return this.id};var g=function(a,b,c){if(a&&a.id){var d=a;for(var e in d)this[e]=d[e]}else this.objectType="Activity",this.id=a,(b||c)&&(this.definition={},"string"==typeof b||b instanceof String?this.definition.name={"en-US":b}:b&&(this.definition.name=b),"string"==typeof c||c instanceof String?this.definition.description={"en-US":c}:c&&(this.definition.description=c))};g.prototype.toString=function(){return this.definition&&this.definition.name&&(this.definition.name["en-US"]||this.definition.name.en)?this.definition.name["en-US"]||this.definition.name.en:this.id},g.prototype.isValid=function(){return this.id&&(!this.objectType||"Activity"===this.objectType)};var h=function(a){if(a&&a.id)for(var b in a)this[b]=a[b];else this.objectType="StatementRef",this.id=a};h.prototype.toString=function(){return"statement("+this.id+")"},h.prototype.isValid=function(){return this.id&&this.objectType&&"StatementRef"===this.objectType};var i=function(a,b,d){c.call(this,a,b,d),this.objectType="SubStatement",delete this.id,delete this.stored,delete this.version,delete this.authority};i.prototype=new c,i.prototype.toString=function(){return'"'+i.prototype.prototype.toString.call(this)+'"'},c.Agent=d,c.Group=e,c.Verb=f,c.Activity=g,c.StatementRef=h,c.SubStatement=i,a.XAPIStatement=c}(window.ADL=window.ADL||{});